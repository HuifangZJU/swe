# 再谈字符集

## 为什么要再谈字符集编码

之前写过一篇[博文](http://mirsking.com/2016/05/07/character_set)讲字符集编码，但是只是简单罗列了一些不同的字符集，以及他们的历史起源等等。看完还是云雾缭绕。

这篇博文是在看了廖雪峰的Python教程的字符串与编码章节之后顿悟的结果。[原文链接](http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431664106267f12e9bef7ee14cf6a8776a479bdec9b9000)。


##  ASCII vs Unicode vs UTF-8

ASCII用一个字节（其实是用7位）来表示一个字符。

ASCII是美国人发明的，在处理中文、日文、韩文就捉襟见肘了。所以国人制定了`GB2312`编码，日本人定义了`Shift_JIS`编码，韩国人制定了`Euc_kr`标准。各国有各国的标准，语言混排就必然出现冲突从而导致乱码。然后Unicode来了一个大一统。Unicode标准有很多，但是一般用两个字节表示一个字符（如果用到非常偏僻的字符，则用4个字节）。

但是有一个问题是，本来用一个字节表示的英文字母，在UNICODE中要在前边补占位符0，这样在网络传输上浪费带宽，在数据存储时浪费存储空间。所以马上有人提出了可边长编码`UTF-8`。`UTF-8`用一个字节来表示英文字符，三个字节来表示中文字符，偏僻的字符可能会用到6个字节。如下表所示：


| 字符 | ASCII    | UNICODE           | UTF-8                      |
|------|----------|-------------------|----------------------------|
| A    | 01000001 | 00000000 01000001 | 01000001                   |
| 中   | x        | 01001110 00101101 | 11100100 10111000 10101101 |

## UTF-8为什么用三个字节表示汉字

`UTF-8`规定：

* 用一个字节表示一个字符时：第一个字节的第一位是0，也就是`0xxx xxxx`
* 用两个字节表示一个字符时：第一个字节的前三位是110，第二个字节的前两位是10，也就是`110xxxxx 10xxxxxx`
* 用三个字节表示一个字符时：第一个字节的前四位是1110，第二和第三个字节的前两位是10，也就是`1110xxxx 10xxxxxx 10xxxxxx`。实际有效位是16位，刚好对应Unicode的两个字节表示一个汉字。
